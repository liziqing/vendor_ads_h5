define(["wx","base/env","base/wx","base/util","jquery","swiper","imgLoadCatch","fullpage","jScrollPane"],function(e,a,t,o,n,c){!function(){var e=n(".loading-bar-active"),a=1,t=function(e,a){return Math.floor(Math.random()*(a-e+1)+e)},o=function(){var c=t(10,30);setTimeout(function(){if(window.loaded)return e.css("width","100%"),void n(".percent-num").text("100%");a+=t(1,5),a>98&&(a=98),e.css("width",a+"%"),n(".percent-num").text(a+"%"),o()},c)};o()}(),n(function(){function o(){l>=0&&l<36?(n(".fourth-screen .actor-img-content").addClass("actor-img-content-0"),n(".third-screen .actor-img-content").addClass("actor-img-content-none")):l>=36&&l<72?(n(".third-screen .actor-img-content").addClass("actor-img-content-36"),n(".fourth-screen .actor-img-content").addClass("actor-img-content-none")):l>=72&&(n(".third-screen .actor-img-content").addClass("actor-img-content-72"),n(".fourth-screen .actor-img-content").addClass("actor-img-content-none"))}function c(){s?n(".voice").addClass("play"):n(".voice").removeClass("play")}window.loaded=!0,setTimeout(function(){n(".loading-screen").fadeOut()},1e3);var i="",l=0,s=!1,r=new Audio;window.innerWidth>768&&n(".pc-mask").show(),console.log(localStorage),localStorage.mobile&&(i=localStorage.mobile),localStorage.actor?1==localStorage.actor?(n(".actor-img").show().attr("src","./img/lyf_cartoon.png"),n(".voice").show(),n(".logo-72").hide()):2==localStorage.actor?(n(".actor-img").show().attr("src","./img/wl_cartoon.png"),n(".voice").show(),n(".logo-72").show()):(n(".actor-img").hide(),n(".voice").hide()):(n(".actor-img").hide(),n(".voice").hide(),n(".logo-72").hide()),n(".scroll-pane").jScrollPane({showArrows:!1,verticalGutter:-16}),n("#main").fullpage({anchors:["","","page3",""],afterLoad:function(e,a){3==a&&n.fn.fullpage.setAllowScrolling(!0),4==a&&n.fn.fullpage.setAllowScrolling(!0)},onLeave:function(e,a,t){if(3==e&&"up"==t)return!1}}),n.fn.fullpage.setAllowScrolling(!1),n(".start-btn").click(function(){_hmt.push(["_trackEvent","start-btn","click"]),stm_clicki("send","event","开始游戏","click"),n.fn.fullpage.moveSectionDown()}),n(".avatar-lyf, .avatar-lyf-cartoon").click(function(){_hmt.push(["_trackEvent","lyf-btn","click"]),n.fn.fullpage.moveSectionDown(),localStorage.setItem("actor",1),n(".actor-img").show().attr("src","./img/lyf_cartoon.png"),n(".voice").show(),n(".logo-72").hide(),s||(r.setAttribute("src","./media/lyf.mp3"),r.play(),s=!0,c(),r.addEventListener("ended",function(){s=!1,c()}))}),n(".avatar-wl, .avatar-wl-cartoon").click(function(){_hmt.push(["_trackEvent","wl-btn","click"]),n.fn.fullpage.moveSectionDown(),localStorage.setItem("actor",2),n(".actor-img").show().attr("src","./img/wl_cartoon.png"),n(".voice").show(),n(".logo-72").show(),s||(r.setAttribute("src","./media/wl.mp3"),r.play(),s=!0,n(".voice").addClass("play"),r.addEventListener("ended",function(){s=!1,n(".voice").removeClass("play")}))}),n(".voice").click(function(){switch(_hmt.push(["_trackEvent","music-btn","click"]),localStorage.actor){case"1":s?(n(".voice").removeClass("play"),r.pause(),s=!1):(n(".voice").addClass("play"),r.setAttribute("src","./media/lyf.mp3"),r.play(),s=!0,r.addEventListener("ended",function(){s=!1,n(".voice").removeClass("play")}));break;case"2":s?(n(".voice").removeClass("play"),r.pause(),s=!1):(n(".voice").addClass("play"),r.setAttribute("src","./media/wl.mp3"),r.play(),s=!0,r.addEventListener("ended",function(){s=!1,n(".voice").removeClass("play")}))}}),n(".rule-btn").click(function(){_hmt.push(["_trackEvent","rule-btn","click"]),n(".mask").hide(),n(".weui_mask").fadeIn(),n(".rule-mask").fadeIn()}),n(".close-btn").click(function(){_hmt.push(["_trackEvent","rule-confirm-btn","click"]),n(".weui_mask").fadeOut(),n(".mask").fadeIn()}),function(){n.ajax({type:"GET",url:"http://"+a.apidomain+"/kangshifu/huo-li?mobile="+i,data:{random:Math.random(),format:"jsonp"},dataType:"jsonp",jsonp:"callback",success:function(e){0==e.code&&(l=e.data.value,n(".score-num").text(l),o())},error:function(e){console.log("ajaxFailure")}})}(),n(".bgm-btn").click(function(){bgm.paused?(bgm.play(),n(".bgm-btn").removeClass("pause").addClass("play")):(bgm.pause(),n(".bgm-btn").removeClass("play").addClass("pause"))});var m={shareTitle:"【康师傅绿茶健康活力派】",shareUrl:"http://kangshifu.qnmami.com",shareImg:"http://kangshifu.qnmami.com/img/slogan.png",shareDes:"快一起来参加【#康师傅绿茶健康活力派#活力时刻】，赢李易峰x吴磊见面会门票~"};t.initWxJs("wx8e56a8ebb0688ab9","pt_christmas",["onMenuShareTimeline","onMenuShareAppMessage"],function(){e.onMenuShareTimeline({title:m.shareTitle,link:m.shareUrl,imgUrl:m.shareImg,success:function(){},cancel:function(){}}),e.onMenuShareAppMessage({title:m.shareTitle,link:m.shareUrl,desc:m.shareDes,imgUrl:m.shareImg,type:"",dataUrl:"",success:function(){},cancel:function(){}})})})});